{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\chris\\\\.vscode\\\\Desktop\\\\Full Stack Projects\\\\Node.js-User-Auth\\\\frontend\\\\src\\\\components\\\\auth.js\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$(),\n  _s3 = $RefreshSig$();\nimport { createContext, useContext, useEffect, useState } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nlet internalToken = null;\nexport function getToken() {\n  return internalToken;\n}\nexport async function getTokenInternal() {\n  const url = `${process.env.REACT_APP_POSTS_API_HOST}/token`;\n  try {\n    const response = await fetch(url, {\n      credentials: 'include'\n    });\n    if (response.ok) {\n      const data = await response.json();\n      internalToken = data.access_token;\n      return internalToken;\n    }\n  } catch (e) {}\n  return false;\n}\nexport const AuthContext = /*#__PURE__*/createContext({\n  token: null,\n  setToken: () => null\n});\nexport const AuthProvider = _ref => {\n  _s();\n  let {\n    children\n  } = _ref;\n  const [token, setToken] = useState(null);\n  return /*#__PURE__*/_jsxDEV(AuthContext.Provider, {\n    value: {\n      token,\n      setToken\n    },\n    children: children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 28,\n    columnNumber: 3\n  }, this);\n};\n_s(AuthProvider, \"e+LEOB8XbRIRiSUQHKM4ToWFki4=\");\n_c = AuthProvider;\nexport const useAuthContext = () => {\n  _s2();\n  return useContext(AuthContext);\n};\n_s2(useAuthContext, \"gDsCjeeItUuvgOWf1v4qoK9RF6k=\");\nexport function useToken() {\n  _s3();\n  const {\n    token,\n    setToken\n  } = useAuthContext();\n  const navigate = useNavigate();\n  useEffect(() => {\n    async function fetchToken() {\n      const token = await getTokenInternal();\n      setToken(token);\n    }\n    if (!token) {\n      fetchToken();\n    }\n  }, [setToken, token]);\n}\n_s3(useToken, \"KoxTlUa3Ivbd62mBL6cWLJPosiw=\", false, function () {\n  return [useAuthContext, useNavigate];\n});\nvar _c;\n$RefreshReg$(_c, \"AuthProvider\");","map":{"version":3,"names":["createContext","useContext","useEffect","useState","useNavigate","jsxDEV","_jsxDEV","internalToken","getToken","getTokenInternal","url","process","env","REACT_APP_POSTS_API_HOST","response","fetch","credentials","ok","data","json","access_token","e","AuthContext","token","setToken","AuthProvider","_ref","_s","children","Provider","value","fileName","_jsxFileName","lineNumber","columnNumber","_c","useAuthContext","_s2","useToken","_s3","navigate","fetchToken","$RefreshReg$"],"sources":["C:/Users/chris/.vscode/Desktop/Full Stack Projects/Node.js-User-Auth/frontend/src/components/auth.js"],"sourcesContent":["import { createContext, useContext, useEffect, useState } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nlet internalToken = null;\r\nexport function getToken() {\r\n\treturn internalToken;\r\n}\r\nexport async function getTokenInternal() {\r\n\tconst url = `${process.env.REACT_APP_POSTS_API_HOST}/token`;\r\n\ttry {\r\n\t\tconst response = await fetch(url, {\r\n\t\t\tcredentials: 'include',\r\n\t\t});\r\n\t\tif (response.ok) {\r\n\t\t\tconst data = await response.json();\r\n\t\t\tinternalToken = data.access_token;\r\n\t\t\treturn internalToken;\r\n\t\t}\r\n\t} catch (e) {}\r\n\treturn false;\r\n}\r\nexport const AuthContext = createContext({\r\n\ttoken: null,\r\n\tsetToken: () => null,\r\n});\r\nexport const AuthProvider = ({ children }) => {\r\n\tconst [token, setToken] = useState(null);\r\n\treturn (\r\n\t\t<AuthContext.Provider value={{ token, setToken }}>\r\n\t\t\t{children}\r\n\t\t</AuthContext.Provider>\r\n\t);\r\n};\r\nexport const useAuthContext = () => useContext(AuthContext);\r\nexport function useToken() {\r\n\tconst { token, setToken } = useAuthContext();\r\n\tconst navigate = useNavigate();\r\n\tuseEffect(() => {\r\n\t\tasync function fetchToken() {\r\n\t\t\tconst token = await getTokenInternal();\r\n\t\t\tsetToken(token);\r\n\t\t}\r\n\t\tif (!token) {\r\n\t\t\tfetchToken();\r\n\t\t}\r\n\t}, [setToken, token]);\r\n}\r\n"],"mappings":";;;;AAAA,SAASA,aAAa,EAAEC,UAAU,EAAEC,SAAS,EAAEC,QAAQ,QAAQ,OAAO;AACtE,SAASC,WAAW,QAAQ,kBAAkB;AAAC,SAAAC,MAAA,IAAAC,OAAA;AAC/C,IAAIC,aAAa,GAAG,IAAI;AACxB,OAAO,SAASC,QAAQA,CAAA,EAAG;EAC1B,OAAOD,aAAa;AACrB;AACA,OAAO,eAAeE,gBAAgBA,CAAA,EAAG;EACxC,MAAMC,GAAG,GAAI,GAAEC,OAAO,CAACC,GAAG,CAACC,wBAAyB,QAAO;EAC3D,IAAI;IACH,MAAMC,QAAQ,GAAG,MAAMC,KAAK,CAACL,GAAG,EAAE;MACjCM,WAAW,EAAE;IACd,CAAC,CAAC;IACF,IAAIF,QAAQ,CAACG,EAAE,EAAE;MAChB,MAAMC,IAAI,GAAG,MAAMJ,QAAQ,CAACK,IAAI,EAAE;MAClCZ,aAAa,GAAGW,IAAI,CAACE,YAAY;MACjC,OAAOb,aAAa;IACrB;EACD,CAAC,CAAC,OAAOc,CAAC,EAAE,CAAC;EACb,OAAO,KAAK;AACb;AACA,OAAO,MAAMC,WAAW,gBAAGtB,aAAa,CAAC;EACxCuB,KAAK,EAAE,IAAI;EACXC,QAAQ,EAAEA,CAAA,KAAM;AACjB,CAAC,CAAC;AACF,OAAO,MAAMC,YAAY,GAAGC,IAAA,IAAkB;EAAAC,EAAA;EAAA,IAAjB;IAAEC;EAAS,CAAC,GAAAF,IAAA;EACxC,MAAM,CAACH,KAAK,EAAEC,QAAQ,CAAC,GAAGrB,QAAQ,CAAC,IAAI,CAAC;EACxC,oBACCG,OAAA,CAACgB,WAAW,CAACO,QAAQ;IAACC,KAAK,EAAE;MAAEP,KAAK;MAAEC;IAAS,CAAE;IAAAI,QAAA,EAC/CA;EAAQ;IAAAG,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,QACa;AAEzB,CAAC;AAACP,EAAA,CAPWF,YAAY;AAAAU,EAAA,GAAZV,YAAY;AAQzB,OAAO,MAAMW,cAAc,GAAGA,CAAA;EAAAC,GAAA;EAAA,OAAMpC,UAAU,CAACqB,WAAW,CAAC;AAAA;AAACe,GAAA,CAA/CD,cAAc;AAC3B,OAAO,SAASE,QAAQA,CAAA,EAAG;EAAAC,GAAA;EAC1B,MAAM;IAAEhB,KAAK;IAAEC;EAAS,CAAC,GAAGY,cAAc,EAAE;EAC5C,MAAMI,QAAQ,GAAGpC,WAAW,EAAE;EAC9BF,SAAS,CAAC,MAAM;IACf,eAAeuC,UAAUA,CAAA,EAAG;MAC3B,MAAMlB,KAAK,GAAG,MAAMd,gBAAgB,EAAE;MACtCe,QAAQ,CAACD,KAAK,CAAC;IAChB;IACA,IAAI,CAACA,KAAK,EAAE;MACXkB,UAAU,EAAE;IACb;EACD,CAAC,EAAE,CAACjB,QAAQ,EAAED,KAAK,CAAC,CAAC;AACtB;AAACgB,GAAA,CAZeD,QAAQ;EAAA,QACKF,cAAc,EACzBhC,WAAW;AAAA;AAAA,IAAA+B,EAAA;AAAAO,YAAA,CAAAP,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}